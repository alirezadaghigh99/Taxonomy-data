output file:
processed_classes-pyro_loss, 44.json
function:
_loss
Error Cases:

Pass or Failed: 0

Related Failed Test Cases:
{'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized_vectorized', '../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_reparameterized FAILED [ 30%]', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-ReweightedWakeSleep]', '../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized FAILED [ 83%]', '../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-ReweightedWakeSleep] FAILED [ 42%]', '../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_reparameterized FAILED [ 14%]', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_nonreparameterized', '../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_nonreparameterized FAILED [ 29%]', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-ReweightedWakeSleep]', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_reparameterized', '../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized_vectorized FAILED [ 85%]', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_nonreparameterized', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized', '../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-ReweightedWakeSleep] FAILED [ 54%]', '../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_nonreparameterized FAILED [ 13%]', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized_vectorized', 'FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_reparameterized', '../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized FAILED [ 80%]', '../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized_vectorized FAILED [ 82%]'}

All Test Cases On Generated code:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/pyro/pyro/venv/bin/python3
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/pyro/pyro
configfile: setup.cfg
collecting ... collected 68 items

../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_analytic_kl PASSED [  1%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_nonreparameterized PASSED [  2%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_reparameterized PASSED [  4%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_tail_adaptive PASSED [  5%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_mmd_nonvectorized PASSED [  7%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_mmd_vectorized PASSED [  8%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_renyi_nonreparameterized PASSED [ 10%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_renyi_reparameterized PASSED [ 11%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_nonreparameterized FAILED [ 13%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_reparameterized FAILED [ 14%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_and_model_both_fixed PASSED [ 16%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_and_model_free PASSED [ 17%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_fixed PASSED [ 19%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_model_fixed PASSED [ 20%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_elbo_nonreparameterized PASSED [ 22%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_elbo_reparameterized PASSED [ 23%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_mmd_vectorized PASSED [ 25%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_renyi_nonreparameterized PASSED [ 26%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_renyi_reparameterized PASSED [ 27%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_nonreparameterized FAILED [ 29%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_reparameterized FAILED [ 30%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTrace_ELBO] XFAIL [ 32%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTraceGraph_ELBO] XFAIL [ 33%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTraceEnum_ELBO] XFAIL [ 35%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-Trace_ELBO] PASSED [ 36%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-TraceGraph_ELBO] PASSED [ 38%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-TraceEnum_ELBO] PASSED [ 39%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-RenyiELBO] PASSED [ 41%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-ReweightedWakeSleep] FAILED [ 42%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTrace_ELBO] XFAIL [ 44%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTraceGraph_ELBO] XFAIL [ 45%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTraceEnum_ELBO] XFAIL [ 47%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-Trace_ELBO] PASSED [ 48%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-TraceGraph_ELBO] PASSED [ 50%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-TraceEnum_ELBO] PASSED [ 51%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-RenyiELBO] PASSED [ 52%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-ReweightedWakeSleep] FAILED [ 54%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTrace_ELBO] XFAIL [ 55%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTraceGraph_ELBO] XFAIL [ 57%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTraceEnum_ELBO] XFAIL [ 58%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-Trace_ELBO] PASSED [ 60%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-TraceGraph_ELBO] PASSED [ 61%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-TraceEnum_ELBO] PASSED [ 63%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-RenyiELBO] XFAIL [ 64%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-ReweightedWakeSleep] XFAIL [ 66%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_nonreparameterized PASSED [ 67%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_nonreparameterized_vectorized PASSED [ 69%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_reparameterized PASSED [ 70%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_reparameterized_vectorized PASSED [ 72%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_mmd_vectorized PASSED [ 73%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_nonreparameterized PASSED [ 75%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_nonreparameterized_vectorized PASSED [ 76%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_reparameterized PASSED [ 77%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_reparameterized_vectorized PASSED [ 79%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized FAILED [ 80%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized_vectorized FAILED [ 82%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized FAILED [ 83%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized_vectorized FAILED [ 85%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_duplicate_names PASSED [ 86%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_duplicate_obs_name PASSED [ 88%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_extra_samples PASSED [ 89%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_univariate[0] PASSED [ 91%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_univariate[0.0001] PASSED [ 92%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_multivariate[0] PASSED [ 94%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_multivariate[1] PASSED [ 95%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_reparam_stable PASSED [ 97%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_sequential_plating_sum PASSED [ 98%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_non_nested_plating_sum PASSED [100%]

=================================== FAILURES ===================================
________________ NormalNormalTests.test_rws_nonreparameterized _________________

self = <tests.infer.test_inference.NormalNormalTests testMethod=test_rws_nonreparameterized>

    def test_rws_nonreparameterized(self):
>       self.do_elbo_test(False, 7500, ReweightedWakeSleep(num_particles=3))

../publishablew/pyro/pyro/tests/infer/test_inference.py:104: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:171: in do_elbo_test
    assert_equal(0.0, loc_error, prec=0.05)
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = 0.0, expected = 0.05116507423978465, atol = 0.05, rtol = 0
msg = '0.0 vs 0.05116507423978465'

    def assert_close(actual, expected, atol=1e-7, rtol=0, msg=""):
        if not msg:
            msg = "{} vs {}".format(actual, expected)
        if isinstance(actual, numbers.Number) and isinstance(expected, numbers.Number):
>           assert actual == approx(expected, abs=atol, rel=rtol), msg
E           AssertionError: 0.0 vs 0.05116507423978465

../publishablew/pyro/pyro/tests/common.py:202: AssertionError
__________________ NormalNormalTests.test_rws_reparameterized __________________

self = <tests.infer.test_inference.NormalNormalTests testMethod=test_rws_reparameterized>

    def test_rws_reparameterized(self):
>       self.do_elbo_test(True, 2500, ReweightedWakeSleep(num_particles=3))

../publishablew/pyro/pyro/tests/infer/test_inference.py:101: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:172: in do_elbo_test
    assert_equal(0.0, log_sig_error, prec=0.05)
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = 0.0, expected = 0.10088552804304388, atol = 0.05, rtol = 0
msg = '0.0 vs 0.10088552804304388'

    def assert_close(actual, expected, atol=1e-7, rtol=0, msg=""):
        if not msg:
            msg = "{} vs {}".format(actual, expected)
        if isinstance(actual, numbers.Number) and isinstance(expected, numbers.Number):
>           assert actual == approx(expected, abs=atol, rel=rtol), msg
E           AssertionError: 0.0 vs 0.10088552804304388

../publishablew/pyro/pyro/tests/common.py:202: AssertionError
________________ PoissonGammaTests.test_rws_nonreparameterized _________________

self = <tests.infer.test_inference.PoissonGammaTests testMethod=test_rws_nonreparameterized>

    def test_rws_nonreparameterized(self):
>       self.do_elbo_test(False, 12500, ReweightedWakeSleep(num_particles=2))

../publishablew/pyro/pyro/tests/infer/test_inference.py:337: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:385: in do_elbo_test
    assert_equal(
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
../publishablew/pyro/pyro/tests/common.py:218: in assert_close
    assert_tensors_equal(actual, expected, prec, msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

a = tensor(8.2493, grad_fn=<AddBackward0>), b = tensor(7.), prec = 0.2
msg = '8.249327039153368 vs 7.0'

    def assert_tensors_equal(a, b, prec=0.0, msg=""):
        assert a.size() == b.size(), msg
        if isinstance(prec, numbers.Number) and prec == 0:
            assert (a == b).all(), msg
            return
        if a.numel() == 0 and b.numel() == 0:
            return
        b = b.type_as(a)
        b = b.cuda(device=a.get_device()) if a.is_cuda else b.cpu()
        if not a.dtype.is_floating_point:
            assert (a == b).all(), msg
            return
        # check that NaNs are in the same locations
        nan_mask = a != a
        assert torch.equal(nan_mask, b != b), msg
        diff = a - b
        diff[a == b] = 0  # handle inf
        diff[nan_mask] = 0
        if diff.is_signed():
            diff = diff.abs()
        if isinstance(prec, torch.Tensor):
            assert (diff <= prec).all(), msg
        else:
            max_err = diff.max().item()
>           assert max_err <= prec, msg
E           AssertionError: 8.249327039153368 vs 7.0

../publishablew/pyro/pyro/tests/common.py:170: AssertionError
__________________ PoissonGammaTests.test_rws_reparameterized __________________

self = <tests.infer.test_inference.PoissonGammaTests testMethod=test_rws_reparameterized>

    def test_rws_reparameterized(self):
>       self.do_elbo_test(True, 5000, ReweightedWakeSleep(num_particles=2))

../publishablew/pyro/pyro/tests/infer/test_inference.py:334: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:385: in do_elbo_test
    assert_equal(
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
../publishablew/pyro/pyro/tests/common.py:218: in assert_close
    assert_tensors_equal(actual, expected, prec, msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

a = tensor(8.2453, grad_fn=<AddBackward0>), b = tensor(7.), prec = 0.2
msg = '8.245299639218915 vs 7.0'

    def assert_tensors_equal(a, b, prec=0.0, msg=""):
        assert a.size() == b.size(), msg
        if isinstance(prec, numbers.Number) and prec == 0:
            assert (a == b).all(), msg
            return
        if a.numel() == 0 and b.numel() == 0:
            return
        b = b.type_as(a)
        b = b.cuda(device=a.get_device()) if a.is_cuda else b.cpu()
        if not a.dtype.is_floating_point:
            assert (a == b).all(), msg
            return
        # check that NaNs are in the same locations
        nan_mask = a != a
        assert torch.equal(nan_mask, b != b), msg
        diff = a - b
        diff[a == b] = 0  # handle inf
        diff[nan_mask] = 0
        if diff.is_signed():
            diff = diff.abs()
        if isinstance(prec, torch.Tensor):
            assert (diff <= prec).all(), msg
        else:
            max_err = diff.max().item()
>           assert max_err <= prec, msg
E           AssertionError: 8.245299639218915 vs 7.0

../publishablew/pyro/pyro/tests/common.py:170: AssertionError
_____________ test_exponential_gamma[reparam-ReweightedWakeSleep] ______________

gamma_dist = <class 'pyro.distributions.torch.Gamma'>, n_steps = 5000
elbo_impl = <class 'pyro.infer.rws.ReweightedWakeSleep'>

    @pytest.mark.stage("integration", "integration_batch_1")
    @pytest.mark.parametrize(
        "elbo_impl",
        [
            xfail_param(JitTrace_ELBO, reason="incorrect gradients", run=False),
            xfail_param(JitTraceGraph_ELBO, reason="incorrect gradients", run=False),
            xfail_param(JitTraceEnum_ELBO, reason="incorrect gradients", run=False),
            Trace_ELBO,
            TraceGraph_ELBO,
            TraceEnum_ELBO,
            RenyiELBO,
            ReweightedWakeSleep,
        ],
    )
    @pytest.mark.parametrize(
        "gamma_dist,n_steps",
        [
            (dist.Gamma, 5000),
            (fakes.NonreparameterizedGamma, 10000),
            (ShapeAugmentedGamma, 5000),
        ],
        ids=["reparam", "nonreparam", "rsvi"],
    )
    def test_exponential_gamma(gamma_dist, n_steps, elbo_impl):
        pyro.clear_param_store()
    
        # gamma prior hyperparameter
        alpha0 = torch.tensor(1.0)
        # gamma prior hyperparameter
        beta0 = torch.tensor(1.0)
        n_data = 2
        data = torch.tensor([3.0, 2.0])  # two observations
        alpha_n = alpha0 + torch.tensor(float(n_data))  # posterior alpha
        beta_n = beta0 + torch.sum(data)  # posterior beta
        prec = 0.2 if gamma_dist.has_rsample else 0.25
    
        def model(alpha0, beta0, alpha_n, beta_n):
            lambda_latent = pyro.sample("lambda_latent", gamma_dist(alpha0, beta0))
            with pyro.plate("data", n_data):
                pyro.sample("obs", dist.Exponential(lambda_latent), obs=data)
            return lambda_latent
    
        def guide(alpha0, beta0, alpha_n, beta_n):
            alpha_q = pyro.param(
                "alpha_q", alpha_n * math.exp(0.17), constraint=constraints.positive
            )
            beta_q = pyro.param(
                "beta_q", beta_n / math.exp(0.143), constraint=constraints.positive
            )
            pyro.sample("lambda_latent", gamma_dist(alpha_q, beta_q))
    
        adam = optim.Adam({"lr": 0.0003, "betas": (0.97, 0.999)})
        if elbo_impl is RenyiELBO:
            elbo = elbo_impl(
                alpha=0.2,
                num_particles=3,
                max_plate_nesting=1,
                strict_enumeration_warning=False,
            )
        elif elbo_impl is ReweightedWakeSleep:
            if gamma_dist is ShapeAugmentedGamma:
                pytest.xfail(
                    reason="ShapeAugmentedGamma not suported for ReweightedWakeSleep"
                )
            else:
                elbo = elbo_impl(
                    num_particles=3, max_plate_nesting=1, strict_enumeration_warning=False
                )
        else:
            elbo = elbo_impl(max_plate_nesting=1, strict_enumeration_warning=False)
        svi = SVI(model, guide, adam, loss=elbo)
    
        with xfail_if_not_implemented():
            for k in range(n_steps):
                svi.step(alpha0, beta0, alpha_n, beta_n)
    
>       assert_equal(
            pyro.param("alpha_q"),
            alpha_n,
            prec=prec,
            msg="{} vs {}".format(
                pyro.param("alpha_q").detach().cpu().numpy(), alpha_n.detach().cpu().numpy()
            ),
        )

../publishablew/pyro/pyro/tests/infer/test_inference.py:569: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
../publishablew/pyro/pyro/tests/common.py:218: in assert_close
    assert_tensors_equal(actual, expected, prec, msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

a = tensor(3.6004, grad_fn=<AddBackward0>), b = tensor(3.), prec = 0.2
msg = '3.6004278658098623 vs 3.0'

    def assert_tensors_equal(a, b, prec=0.0, msg=""):
        assert a.size() == b.size(), msg
        if isinstance(prec, numbers.Number) and prec == 0:
            assert (a == b).all(), msg
            return
        if a.numel() == 0 and b.numel() == 0:
            return
        b = b.type_as(a)
        b = b.cuda(device=a.get_device()) if a.is_cuda else b.cpu()
        if not a.dtype.is_floating_point:
            assert (a == b).all(), msg
            return
        # check that NaNs are in the same locations
        nan_mask = a != a
        assert torch.equal(nan_mask, b != b), msg
        diff = a - b
        diff[a == b] = 0  # handle inf
        diff[nan_mask] = 0
        if diff.is_signed():
            diff = diff.abs()
        if isinstance(prec, torch.Tensor):
            assert (diff <= prec).all(), msg
        else:
            max_err = diff.max().item()
>           assert max_err <= prec, msg
E           AssertionError: 3.6004278658098623 vs 3.0

../publishablew/pyro/pyro/tests/common.py:170: AssertionError
____________ test_exponential_gamma[nonreparam-ReweightedWakeSleep] ____________

gamma_dist = <class 'pyro.distributions.testing.fakes.NonreparameterizedGamma'>
n_steps = 10000, elbo_impl = <class 'pyro.infer.rws.ReweightedWakeSleep'>

    @pytest.mark.stage("integration", "integration_batch_1")
    @pytest.mark.parametrize(
        "elbo_impl",
        [
            xfail_param(JitTrace_ELBO, reason="incorrect gradients", run=False),
            xfail_param(JitTraceGraph_ELBO, reason="incorrect gradients", run=False),
            xfail_param(JitTraceEnum_ELBO, reason="incorrect gradients", run=False),
            Trace_ELBO,
            TraceGraph_ELBO,
            TraceEnum_ELBO,
            RenyiELBO,
            ReweightedWakeSleep,
        ],
    )
    @pytest.mark.parametrize(
        "gamma_dist,n_steps",
        [
            (dist.Gamma, 5000),
            (fakes.NonreparameterizedGamma, 10000),
            (ShapeAugmentedGamma, 5000),
        ],
        ids=["reparam", "nonreparam", "rsvi"],
    )
    def test_exponential_gamma(gamma_dist, n_steps, elbo_impl):
        pyro.clear_param_store()
    
        # gamma prior hyperparameter
        alpha0 = torch.tensor(1.0)
        # gamma prior hyperparameter
        beta0 = torch.tensor(1.0)
        n_data = 2
        data = torch.tensor([3.0, 2.0])  # two observations
        alpha_n = alpha0 + torch.tensor(float(n_data))  # posterior alpha
        beta_n = beta0 + torch.sum(data)  # posterior beta
        prec = 0.2 if gamma_dist.has_rsample else 0.25
    
        def model(alpha0, beta0, alpha_n, beta_n):
            lambda_latent = pyro.sample("lambda_latent", gamma_dist(alpha0, beta0))
            with pyro.plate("data", n_data):
                pyro.sample("obs", dist.Exponential(lambda_latent), obs=data)
            return lambda_latent
    
        def guide(alpha0, beta0, alpha_n, beta_n):
            alpha_q = pyro.param(
                "alpha_q", alpha_n * math.exp(0.17), constraint=constraints.positive
            )
            beta_q = pyro.param(
                "beta_q", beta_n / math.exp(0.143), constraint=constraints.positive
            )
            pyro.sample("lambda_latent", gamma_dist(alpha_q, beta_q))
    
        adam = optim.Adam({"lr": 0.0003, "betas": (0.97, 0.999)})
        if elbo_impl is RenyiELBO:
            elbo = elbo_impl(
                alpha=0.2,
                num_particles=3,
                max_plate_nesting=1,
                strict_enumeration_warning=False,
            )
        elif elbo_impl is ReweightedWakeSleep:
            if gamma_dist is ShapeAugmentedGamma:
                pytest.xfail(
                    reason="ShapeAugmentedGamma not suported for ReweightedWakeSleep"
                )
            else:
                elbo = elbo_impl(
                    num_particles=3, max_plate_nesting=1, strict_enumeration_warning=False
                )
        else:
            elbo = elbo_impl(max_plate_nesting=1, strict_enumeration_warning=False)
        svi = SVI(model, guide, adam, loss=elbo)
    
        with xfail_if_not_implemented():
            for k in range(n_steps):
                svi.step(alpha0, beta0, alpha_n, beta_n)
    
>       assert_equal(
            pyro.param("alpha_q"),
            alpha_n,
            prec=prec,
            msg="{} vs {}".format(
                pyro.param("alpha_q").detach().cpu().numpy(), alpha_n.detach().cpu().numpy()
            ),
        )

../publishablew/pyro/pyro/tests/infer/test_inference.py:569: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
../publishablew/pyro/pyro/tests/common.py:218: in assert_close
    assert_tensors_equal(actual, expected, prec, msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

a = tensor(3.6492, grad_fn=<AddBackward0>), b = tensor(3.), prec = 0.25
msg = '3.649221582661287 vs 3.0'

    def assert_tensors_equal(a, b, prec=0.0, msg=""):
        assert a.size() == b.size(), msg
        if isinstance(prec, numbers.Number) and prec == 0:
            assert (a == b).all(), msg
            return
        if a.numel() == 0 and b.numel() == 0:
            return
        b = b.type_as(a)
        b = b.cuda(device=a.get_device()) if a.is_cuda else b.cpu()
        if not a.dtype.is_floating_point:
            assert (a == b).all(), msg
            return
        # check that NaNs are in the same locations
        nan_mask = a != a
        assert torch.equal(nan_mask, b != b), msg
        diff = a - b
        diff[a == b] = 0  # handle inf
        diff[nan_mask] = 0
        if diff.is_signed():
            diff = diff.abs()
        if isinstance(prec, torch.Tensor):
            assert (diff <= prec).all(), msg
        else:
            max_err = diff.max().item()
>           assert max_err <= prec, msg
E           AssertionError: 3.649221582661287 vs 3.0

../publishablew/pyro/pyro/tests/common.py:170: AssertionError
________________ BernoulliBetaTests.test_rws_nonreparameterized ________________

self = <tests.infer.test_inference.BernoulliBetaTests testMethod=test_rws_nonreparameterized>

    def test_rws_nonreparameterized(self):
>       self.do_elbo_test(False, 5000, ReweightedWakeSleep(num_particles=2))

../publishablew/pyro/pyro/tests/infer/test_inference.py:656: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:715: in do_elbo_test
    assert_equal(0.0, alpha_error, prec=0.08)
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = 0.0, expected = 0.09742372598164173, atol = 0.08, rtol = 0
msg = '0.0 vs 0.09742372598164173'

    def assert_close(actual, expected, atol=1e-7, rtol=0, msg=""):
        if not msg:
            msg = "{} vs {}".format(actual, expected)
        if isinstance(actual, numbers.Number) and isinstance(expected, numbers.Number):
>           assert actual == approx(expected, abs=atol, rel=rtol), msg
E           AssertionError: 0.0 vs 0.09742372598164173

../publishablew/pyro/pyro/tests/common.py:202: AssertionError
__________ BernoulliBetaTests.test_rws_nonreparameterized_vectorized ___________

self = <tests.infer.test_inference.BernoulliBetaTests testMethod=test_rws_nonreparameterized_vectorized>

    def test_rws_nonreparameterized_vectorized(self):
>       self.do_elbo_test(
            False,
            5000,
            ReweightedWakeSleep(
                num_particles=2, vectorize_particles=True, max_plate_nesting=1
            ),
        )

../publishablew/pyro/pyro/tests/infer/test_inference.py:668: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:715: in do_elbo_test
    assert_equal(0.0, alpha_error, prec=0.08)
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = 0.0, expected = 0.09742372598164173, atol = 0.08, rtol = 0
msg = '0.0 vs 0.09742372598164173'

    def assert_close(actual, expected, atol=1e-7, rtol=0, msg=""):
        if not msg:
            msg = "{} vs {}".format(actual, expected)
        if isinstance(actual, numbers.Number) and isinstance(expected, numbers.Number):
>           assert actual == approx(expected, abs=atol, rel=rtol), msg
E           AssertionError: 0.0 vs 0.09742372598164173

../publishablew/pyro/pyro/tests/common.py:202: AssertionError
_________________ BernoulliBetaTests.test_rws_reparameterized __________________

self = <tests.infer.test_inference.BernoulliBetaTests testMethod=test_rws_reparameterized>

    def test_rws_reparameterized(self):
>       self.do_elbo_test(True, 5000, ReweightedWakeSleep(num_particles=2))

../publishablew/pyro/pyro/tests/infer/test_inference.py:653: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:715: in do_elbo_test
    assert_equal(0.0, alpha_error, prec=0.08)
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = 0.0, expected = 0.09742372598164173, atol = 0.08, rtol = 0
msg = '0.0 vs 0.09742372598164173'

    def assert_close(actual, expected, atol=1e-7, rtol=0, msg=""):
        if not msg:
            msg = "{} vs {}".format(actual, expected)
        if isinstance(actual, numbers.Number) and isinstance(expected, numbers.Number):
>           assert actual == approx(expected, abs=atol, rel=rtol), msg
E           AssertionError: 0.0 vs 0.09742372598164173

../publishablew/pyro/pyro/tests/common.py:202: AssertionError
____________ BernoulliBetaTests.test_rws_reparameterized_vectorized ____________

self = <tests.infer.test_inference.BernoulliBetaTests testMethod=test_rws_reparameterized_vectorized>

    def test_rws_reparameterized_vectorized(self):
>       self.do_elbo_test(
            True,
            5000,
            ReweightedWakeSleep(
                num_particles=2, vectorize_particles=True, max_plate_nesting=1
            ),
        )

../publishablew/pyro/pyro/tests/infer/test_inference.py:659: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../publishablew/pyro/pyro/tests/infer/test_inference.py:715: in do_elbo_test
    assert_equal(0.0, alpha_error, prec=0.08)
../publishablew/pyro/pyro/tests/common.py:248: in assert_equal
    return assert_close(actual, expected, atol=prec, msg=msg)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = 0.0, expected = 0.09742372598164173, atol = 0.08, rtol = 0
msg = '0.0 vs 0.09742372598164173'

    def assert_close(actual, expected, atol=1e-7, rtol=0, msg=""):
        if not msg:
            msg = "{} vs {}".format(actual, expected)
        if isinstance(actual, numbers.Number) and isinstance(expected, numbers.Number):
>           assert actual == approx(expected, abs=atol, rel=rtol), msg
E           AssertionError: 0.0 vs 0.09742372598164173

../publishablew/pyro/pyro/tests/common.py:202: AssertionError
=========================== short test summary info ============================
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_nonreparameterized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_reparameterized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_nonreparameterized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_reparameterized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-ReweightedWakeSleep]
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-ReweightedWakeSleep]
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized_vectorized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized
FAILED ../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized_vectorized
============ 10 failed, 47 passed, 11 xfailed in 561.73s (0:09:21) =============


Final Test Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/pyro/pyro/venv/bin/python3
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/pyro/pyro
configfile: setup.cfg
collecting ... collected 68 items

../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_analytic_kl PASSED [  1%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_nonreparameterized PASSED [  2%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_reparameterized PASSED [  4%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_tail_adaptive PASSED [  5%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_mmd_nonvectorized PASSED [  7%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_mmd_vectorized PASSED [  8%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_renyi_nonreparameterized PASSED [ 10%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_renyi_reparameterized PASSED [ 11%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_nonreparameterized PASSED [ 13%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_reparameterized PASSED [ 14%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_and_model_both_fixed PASSED [ 16%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_and_model_free PASSED [ 17%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_fixed PASSED [ 19%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_model_fixed PASSED [ 20%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_elbo_nonreparameterized PASSED [ 22%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_elbo_reparameterized PASSED [ 23%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_mmd_vectorized PASSED [ 25%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_renyi_nonreparameterized PASSED [ 26%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_renyi_reparameterized PASSED [ 27%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_nonreparameterized PASSED [ 29%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_reparameterized PASSED [ 30%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTrace_ELBO] XFAIL [ 32%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTraceGraph_ELBO] XFAIL [ 33%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTraceEnum_ELBO] XFAIL [ 35%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-Trace_ELBO] PASSED [ 36%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-TraceGraph_ELBO] PASSED [ 38%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-TraceEnum_ELBO] PASSED [ 39%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-RenyiELBO] PASSED [ 41%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-ReweightedWakeSleep] PASSED [ 42%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTrace_ELBO] XFAIL [ 44%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTraceGraph_ELBO] XFAIL [ 45%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTraceEnum_ELBO] XFAIL [ 47%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-Trace_ELBO] PASSED [ 48%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-TraceGraph_ELBO] PASSED [ 50%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-TraceEnum_ELBO] PASSED [ 51%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-RenyiELBO] PASSED [ 52%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-ReweightedWakeSleep] PASSED [ 54%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTrace_ELBO] XFAIL [ 55%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTraceGraph_ELBO] XFAIL [ 57%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTraceEnum_ELBO] XFAIL [ 58%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-Trace_ELBO] PASSED [ 60%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-TraceGraph_ELBO] PASSED [ 61%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-TraceEnum_ELBO] PASSED [ 63%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-RenyiELBO] XFAIL [ 64%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-ReweightedWakeSleep] XFAIL [ 66%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_nonreparameterized PASSED [ 67%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_nonreparameterized_vectorized PASSED [ 69%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_reparameterized PASSED [ 70%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_reparameterized_vectorized PASSED [ 72%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_mmd_vectorized PASSED [ 73%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_nonreparameterized PASSED [ 75%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_nonreparameterized_vectorized PASSED [ 76%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_reparameterized PASSED [ 77%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_reparameterized_vectorized PASSED [ 79%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized PASSED [ 80%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized_vectorized PASSED [ 82%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized PASSED [ 83%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized_vectorized PASSED [ 85%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_duplicate_names PASSED [ 86%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_duplicate_obs_name PASSED [ 88%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_extra_samples PASSED [ 89%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_univariate[0] PASSED [ 91%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_univariate[0.0001] PASSED [ 92%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_multivariate[0] PASSED [ 94%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_multivariate[1] PASSED [ 95%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_reparam_stable PASSED [ 97%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_sequential_plating_sum PASSED [ 98%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_non_nested_plating_sum PASSED [100%]

================== 57 passed, 11 xfailed in 577.10s (0:09:37) ==================


Initial Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/pyro/pyro/venv/bin/python3
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/pyro/pyro
configfile: setup.cfg
collecting ... collected 68 items

../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_analytic_kl PASSED [  1%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_nonreparameterized PASSED [  2%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_reparameterized PASSED [  4%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_elbo_tail_adaptive PASSED [  5%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_mmd_nonvectorized PASSED [  7%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_mmd_vectorized PASSED [  8%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_renyi_nonreparameterized PASSED [ 10%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_renyi_reparameterized PASSED [ 11%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_nonreparameterized PASSED [ 13%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::NormalNormalTests::test_rws_reparameterized PASSED [ 14%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_and_model_both_fixed PASSED [ 16%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_and_model_free PASSED [ 17%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_guide_fixed PASSED [ 19%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::TestFixedModelGuide::test_model_fixed PASSED [ 20%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_elbo_nonreparameterized PASSED [ 22%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_elbo_reparameterized PASSED [ 23%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_mmd_vectorized PASSED [ 25%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_renyi_nonreparameterized PASSED [ 26%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_renyi_reparameterized PASSED [ 27%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_nonreparameterized PASSED [ 29%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::PoissonGammaTests::test_rws_reparameterized PASSED [ 30%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTrace_ELBO] XFAIL [ 32%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTraceGraph_ELBO] XFAIL [ 33%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-JitTraceEnum_ELBO] XFAIL [ 35%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-Trace_ELBO] PASSED [ 36%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-TraceGraph_ELBO] PASSED [ 38%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-TraceEnum_ELBO] PASSED [ 39%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-RenyiELBO] PASSED [ 41%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[reparam-ReweightedWakeSleep] PASSED [ 42%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTrace_ELBO] XFAIL [ 44%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTraceGraph_ELBO] XFAIL [ 45%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-JitTraceEnum_ELBO] XFAIL [ 47%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-Trace_ELBO] PASSED [ 48%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-TraceGraph_ELBO] PASSED [ 50%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-TraceEnum_ELBO] PASSED [ 51%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-RenyiELBO] PASSED [ 52%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[nonreparam-ReweightedWakeSleep] PASSED [ 54%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTrace_ELBO] XFAIL [ 55%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTraceGraph_ELBO] XFAIL [ 57%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-JitTraceEnum_ELBO] XFAIL [ 58%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-Trace_ELBO] PASSED [ 60%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-TraceGraph_ELBO] PASSED [ 61%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-TraceEnum_ELBO] PASSED [ 63%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-RenyiELBO] XFAIL [ 64%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_exponential_gamma[rsvi-ReweightedWakeSleep] XFAIL [ 66%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_nonreparameterized PASSED [ 67%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_nonreparameterized_vectorized PASSED [ 69%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_reparameterized PASSED [ 70%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_elbo_reparameterized_vectorized PASSED [ 72%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_mmd_vectorized PASSED [ 73%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_nonreparameterized PASSED [ 75%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_nonreparameterized_vectorized PASSED [ 76%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_reparameterized PASSED [ 77%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_renyi_reparameterized_vectorized PASSED [ 79%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized PASSED [ 80%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_nonreparameterized_vectorized PASSED [ 82%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized PASSED [ 83%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::BernoulliBetaTests::test_rws_reparameterized_vectorized PASSED [ 85%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_duplicate_names PASSED [ 86%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_duplicate_obs_name PASSED [ 88%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::SafetyTests::test_extra_samples PASSED [ 89%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_univariate[0] PASSED [ 91%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_univariate[0.0001] PASSED [ 92%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_multivariate[0] PASSED [ 94%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_energy_distance_multivariate[1] PASSED [ 95%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_reparam_stable PASSED [ 97%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_sequential_plating_sum PASSED [ 98%]
../publishablew/pyro/pyro/tests/infer/test_inference.py::test_non_nested_plating_sum PASSED [100%]

================== 57 passed, 11 xfailed in 567.19s (0:09:27) ==================
